{{define "content"}}
<div class="mb-6">
    <h1 class="text-2xl font-bold text-gray-900">Repository</h1>
    <p class="mt-1 text-sm text-gray-500">Download public keys and license files for deployment.</p>
</div>

<!-- Public Keys -->
<div class="bg-white shadow rounded-lg border border-gray-100 p-6 mb-6">
    <h2 class="text-sm font-semibold text-gray-900 mb-4">Public Keys</h2>
    {{if .Keys}}
    <div class="overflow-hidden rounded-lg border border-gray-200">
        <table class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gray-50">
                <tr>
                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Name</th>
                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Fingerprint</th>
                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Default</th>
                    <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase">Download</th>
                </tr>
            </thead>
            <tbody class="divide-y divide-gray-200">
                {{range .Keys}}
                <tr>
                    <td class="px-4 py-3 text-sm font-medium text-gray-900">{{.Name}}</td>
                    <td class="px-4 py-3 text-sm text-gray-500 font-mono text-xs">{{printf "%.16s" .Fingerprint}}...</td>
                    <td class="px-4 py-3 text-sm">
                        {{if .IsDefault}}
                        <span class="inline-flex items-center rounded-full bg-green-50 px-2 py-0.5 text-xs font-medium text-green-700">Default</span>
                        {{else}}-{{end}}
                    </td>
                    <td class="px-4 py-3 text-sm text-right">
                        <a href="/repository/pubkey/{{.ID}}" class="inline-flex items-center gap-1 text-indigo-600 hover:text-indigo-500">
                            <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"/></svg>
                            .pub
                        </a>
                    </td>
                </tr>
                {{end}}
            </tbody>
        </table>
    </div>
    {{else}}
    <p class="text-sm text-gray-500">No public keys available. Generate a key pair first.</p>
    {{end}}
</div>

<!-- License Files -->
<div class="bg-white shadow rounded-lg border border-gray-100 p-6">
    <h2 class="text-sm font-semibold text-gray-900 mb-4">License Files</h2>
    {{if .Licenses}}
    <div class="overflow-hidden rounded-lg border border-gray-200">
        <table class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gray-50">
                <tr>
                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">License ID</th>
                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Customer</th>
                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Project</th>
                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Expires</th>
                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Status</th>
                    <th class="px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase">Download</th>
                </tr>
            </thead>
            <tbody class="divide-y divide-gray-200">
                {{range .Licenses}}
                <tr>
                    <td class="px-4 py-3 text-sm font-medium text-gray-900 font-mono">{{.LicenseID}}</td>
                    <td class="px-4 py-3 text-sm text-gray-500">{{.IssuedTo}}</td>
                    <td class="px-4 py-3 text-sm text-gray-500">{{.ProjectName}}</td>
                    <td class="px-4 py-3 text-sm text-gray-500">{{formatDate .ExpiresAt}}</td>
                    <td class="px-4 py-3 text-sm">
                        {{if isExpired .ExpiresAt}}
                        <span class="inline-flex items-center rounded-full bg-red-50 px-2 py-0.5 text-xs font-medium text-red-700">Expired</span>
                        {{else}}
                        <span class="inline-flex items-center rounded-full bg-green-50 px-2 py-0.5 text-xs font-medium text-green-700">Active</span>
                        {{end}}
                    </td>
                    <td class="px-4 py-3 text-sm text-right">
                        <a href="/repository/license/{{.ID}}" class="inline-flex items-center gap-1 text-indigo-600 hover:text-indigo-500">
                            <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"/></svg>
                            .license
                        </a>
                    </td>
                </tr>
                {{end}}
            </tbody>
        </table>
    </div>
    {{else}}
    <p class="text-sm text-gray-500">No licenses available. Create a license first.</p>
    {{end}}
</div>
{{end}}
